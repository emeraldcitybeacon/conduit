{% load static i18n %}
{% get_current_language as LANGUAGE_CODE %}
<!-- Base template for Pulse pages with daisyUI navbar and drawer -->
<!DOCTYPE html>
<html lang="{{ LANGUAGE_CODE }}">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{% block title %}{% trans "Pulse" %}{% endblock %}</title>
    <link rel="stylesheet" href="{% static 'css/site.css' %}" />
    <meta name="csrf-token" content="{{ csrf_token }}" />
    <script src="https://cdn.jsdelivr.net/npm/htmx.org@1.9.12" integrity="sha384-ujb1lZYygJmzgSwoxRggbCHcjc0rB2XoQrxeTUQyRjrOnlCoYta87iKBWq3EsdM2" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
  </head>
  <body class="min-h-screen bg-base-200">
    <div class="drawer lg:drawer-open">
      <input id="pulse-sidebar" type="checkbox" class="drawer-toggle" />
      <div class="drawer-content flex flex-col">
        <div class="navbar bg-base-100">
          <div class="flex-none lg:hidden">
            <label for="pulse-sidebar" class="btn btn-square btn-ghost">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" /></svg>
            </label>
          </div>
          <div class="flex-1 px-2 mx-2 text-xl font-bold">{% trans "Pulse" %}</div>
        </div>
        <main class="p-4">
          {% block content %}{% endblock %}
        </main>
      </div>
      <div class="drawer-side">
        <label for="pulse-sidebar" class="drawer-overlay"></label>
        <ul class="menu p-4 w-80 min-h-full bg-base-200">
          <li><a href="/">{% trans "Home" %}</a></li>
        </ul>
      </div>
    </div>
    {% component 'shelf_drawer' %}{% endcomponent %}
    {% component 'worklist_picker' %}{% endcomponent %}
    {% block key_overlay %}{% component 'key_overlay' scope='global' %}{% endcomponent %}{% endblock %}
    <script>
      document.body.addEventListener("htmx:configRequest", (event) => {
        const token = document.querySelector('meta[name="csrf-token"]').content;
        event.detail.headers["X-CSRFToken"] = token;
      });
    </script>
    <script src="{% static 'pulse/js/keys.js' %}"></script>
  </body>
</html>
